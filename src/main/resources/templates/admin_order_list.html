<!DOCTYPE html >
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
   <head>
      <!-- basic -->
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- mobile metas -->
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="viewport" content="initial-scale=1, maximum-scale=1">
      <!-- site metas -->
      <title>발주 요청 관리</title>
      <meta name="keywords" content="">
      <meta name="description" content="">
      <meta name="author" content="">
      <!-- site icon -->
      <link rel="icon" href="/images/fevicon.png" type="image/png" />
      <!-- bootstrap css -->
      <link rel="stylesheet" href="/css/bootstrap.min.css" />
      <!-- site css -->
      <link rel="stylesheet" href="/css/style.css" />
      <!-- responsive css -->
      <link rel="stylesheet" href="/css/responsive.css" />
      <!-- color css -->
      <!-- <link rel="stylesheet" href="/css/color_2.css" />  -->
      <link rel="stylesheet" href="/css/colors.css" />
      <!-- select bootstrap -->
      <link rel="stylesheet" href="/css/bootstrap-select.css" />
      <!-- scrollbar css -->
      <link rel="stylesheet" href="/css/perfect-scrollbar.css" />
      <!-- custom css -->
      <link rel="stylesheet" href="/css/custom.css" />
      <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
      <![endif]-->
      
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  	  <link rel="stylesheet" type="text/css" th:href="@{/bootstrap.min.css}">
    
      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
    	<!-- <script src="https://code.jquery.com/jquery-3.5.1.min.js"
            integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
            crossorigin="anonymous"></script>  -->
    
    
   	  <style>
   	    #modalOpenButton, #modalCloseButton {
		  cursor: pointer;
		}
		
		#modalContainer {
		  width: 100%;
		  height: 100%;
		  position: fixed;
		  top: 0;
		  left: 0;
		  display: flex;
		  justify-content: center;
		  align-items: center;
		  background: rgba(0, 0, 0, 0.5);
		}
		
		#modalContent {
		  position: absolute;
		  background-color: #ffffff;
		  width: 1000px;
		  height: 500px;
		  padding: 15px;
		}
		
		#modalContainer.hidden {
		  display: none;
		}
   	  
   	  </style>
   
   </head>
   <body class="dashboard dashboard_1">
      <div class="full_container">
         <div class="inner_container">
            <head th:include="fragments/sidebar :: sidebar"></head>
            <!-- right content -->
            <div id="content">
            	<head th:include="fragments/topbar :: topbar"></head>


			<!-- 메인 내용 -->
                 <div class="main p-5">
		      <h6>
		         <strong>발주 요청 목록</strong>
		      </h6>
		      <form action="searchProduct" method="post">
		         <table class="table table-bordered">
		            <tr>
		               <th>검색어</th>
		               <td><select name="searchType">
		                     <option value="product_name">지점명</option>
		                     <option value="product_code">발주내용</option>
		                     <!--  <option value="product_category">카테고리 번호</option> -->
		               </select> <input type="text" name="searchKeyword" placeholder="검색어 입력">
		               </td>
		            </tr>
               <tr>
               <th>발주일자</th>
               <td>
                <input type="date" id="endDate" name="endDate"> - 
                <input   type="date" id="startDate" name="startDate">
                  <div class="date-buttons" style="display: inline-block;">
                     <button type="button" onclick="setDate(-1)">1일</button>
                     <button type="button" onclick="setDate(-3)">3일</button>
                     <button type="button" onclick="setDate(-7)">일주일</button>
                     <button type="button" onclick="setDate(-30)">한달</button>
                  </div>
               </td>
            </tr>
            <tr>
               <th>납기일자</th>
               <td>
                <input type="date" id="endDate" name="endDate"> - 
                <input   type="date" id="startDate" name="startDate">
                  <div class="date-buttons" style="display: inline-block;">
                     <button type="button" onclick="setDate(-1)">1일</button>
                     <button type="button" onclick="setDate(-3)">3일</button>
                     <button type="button" onclick="setDate(-7)">일주일</button>
                     <button type="button" onclick="setDate(-30)">한달</button>
                  </div>
               </td>
            </tr>
            <tr>
               <th>발주상태</th>
               <td>
					<input type="radio" name="order_status" value="0" checked="checked">발주대기
					<input type="radio" name="order_status" value="1">발주승인
					<input type="radio" name="order_status" value="2">발주취소
					<input type="radio" name="order_status" value="3">입고완료
               </td>
            </tr>
            
            
         </table>
         <div style="text-align: right;">
            <button type="submit" class="btn btn-primary btn-sm"
               style="width: 70px; border-radius: 8px;">검색</button>
            <button type="reset" class="btn btn-secondary btn-sm"
               style="width: 70px; border-radius: 8px;">초기화</button>
         </div>
      </form>
      <hr style="color: black">

      <div class="wrapper mt-5" id="productListContainer">

         <table class="table product-list-table">
            <thead>
               <tr>

                  <th class="table-light text-center">NO</th>
                  <th class="table-light text-center">지점명</th>
                  <th class="table-light text-center">발주일자</th>
                  <th class="table-light text-center">납기일자</th>
                  <th class="table-light text-center">발주내용</th>
                  <th class="table-light text-center">발주수량</th>
                  <th class="table-light text-center">총 금액</th>
                  <th class="table-light text-center">발주상태</th>
                  <th class="table-light text-center">관리</th>
               </tr>
            </thead>
            <tbody>
             
            	<th::block th:each="str: ${list}">
					     <tr>
	                         <td style="text-align: center;">[[${str.order_id}]]</td>
	                         <td style="text-align: center;">[[${str.order_partner}]]</td>
	                         <td style="text-align: center;">[[${str.order_date}]]</td>
	                         <td style="text-align: center;">[[${str.order_delivery}]]</td>
	                         <td style="text-align: center;">내용</td>
	                         <td style="text-align: center;">[[${str.order_amount}]]</td>
  	                         <td style="text-align: center;">[[${str.order_sum}]]</td>
  	                         <td style="text-align: center;">[[${str.order_status}]]</td>
                         	 <td style="text-align: center;"><button th:onclick="orderDetail2([[${str.order_id}]])">상세보기</button></td>
	                      </tr> 
				</th:block>
 			
            </tbody>
         </table>
         <br>
         <div></div>
         <br>
      </div>



		<!-- 모달 -->
		 <div id="modalContainer" class="hidden">
		  <div id="modalContent">
		    <span>발주 상세 정보</span>
		    <span><button id="modalCloseButton">닫기</button></span>
		    
		          
		      	<input id="order_id" type="text"/> 
		      	<input id="order_partner" type="text"/>
		      	<input id="order_sender" type="text"/>
		      	<input id="order_date" type="text"/>
		      	<input id="order_amount" type="text"/>
		      	<input id="order_sum" type="text"/>
		      	<input id="order_status" type="text"/>
		      	<input id="order_manager" type="text"/>
		      	<input id="order_delivery" type="text"/>
		      	<input id="order_memo" type="text"/>
		   
		   <!-- 
		    	<table>
		    		<tr>
		    			<th>No</th>
		    			<td>13</td>
		    		</tr>
		    		<tr>
		    			<th>발주일자</td>
		    			<td >2024.12.23</td>
		    		</tr>
		    		<tr>
		    			<th>납기일자</th>
		    			<td>2024.12.25</td>
		    		</tr>
		    		<tr>
		    			<th>지점명</th>
		    			<td>수원인계점</td>
		    		</tr>
		    		<tr>
		    			<th>담당자 명</th>
		    			<td>김점장</td>
		    		</tr>
		    		<tr>
		    			<th>메모사항</th>
		    			<td>메모입니다~~</td>
		    		</tr>
		    	</table>
		    	 -->
		    	
		    	<!-- 
		    <table class="table product-list-table">
	            <thead>
	               <tr>
	                  <th class="table-light text-center">NO</th>
	                  <th class="table-light text-center">회사명</th>
	                  <th class="table-light text-center">상품명</th>
	                  <th class="table-light text-center">수량</th>
	                  <th class="table-light text-center">단가</th>
	                  <th class="table-light text-center">총 금액</th>
	               </tr>
	            </thead>
	            <tbody>
	               <tr>
	               	  <c:forEach var="product" items="${productList}">
	                      <tr>
	                         <td style="text-align: center;" id="orderDetail_id">1</td>
	                         <td style="text-align: center;" id="orderDetail_orderid">롯데제과</td>
	                         <td style="text-align: center;" id="orderDetail_productid">가나 초콜릿</td>
	                         <td style="text-align: center;" id="orderDetail_amount">30개</td>
	                         <td style="text-align: center;" id="orderDetail_price">1,500원</td>
	                         <td style="text-align: center;" id="orderDetail_sum">45,000원</td>
	                      </tr>    
	                </c:forEach>
	            </tbody>
         	</table>  -->
         	
				<div id="productListContainer">
				    <table class="table product-list-table">
				        <thead>
				            <tr>
				                <th class="table-light text-center">NO</th>
				                <th class="table-light text-center">Order ID</th>
				                <th class="table-light text-center">Product ID</th>
				                <th class="table-light text-center">Price</th>
				                <th class="table-light text-center">Amount</th>
				                <th class="table-light text-center">Sum</th>
				            </tr>
				        </thead>
				        <tbody>
				            <!-- 데이터가 여기 추가됩니다 -->
				        </tbody>
				    </table>
				</div>

         	

		  </div>
		</div>

<!-- 
		<div class="pagination-container">
		    <div class="pagination">
		        <c:if test="${startPage > 1}">
		            <a href="${basePath}?pageNum=${startPage - 1}&pageListNum=${pageListNum}&searchType=${searchType}&searchKeyword=${searchKeyword}&startDate=${startDate}&endDate=${endDate}">&lt;</a>
		        </c:if>
		        <c:forEach begin="${startPage}" end="${endPage}" var="page">
		            <a href="${basePath}?pageNum=${page}&pageListNum=${pageListNum}&searchType=${searchType}&searchKeyword=${searchKeyword}&startDate=${startDate}&endDate=${endDate}"
		               class="${currentPage == page ? 'active' : ''}">${page}</a>
		        </c:forEach>
		        <c:if test="${endPage < totalPage}">
		            <a href="${basePath}?pageNum=${endPage + 1}&pageListNum=${pageListNum}&searchType=${searchType}&searchKeyword=${searchKeyword}&startDate=${startDate}&endDate=${endDate}">&gt;</a>
		        </c:if>
		    </div>
		</div>  -->
	 
   </div>
               
   <!-- 메인 내용 END -->
               

            </div>
         </div>
      </div>
      
    
    <script>
	      function orderDetail2(order_id) {
		    	alert("디테일정보");
		    	alert(order_id);
		    	
		    	    $.ajax({
		    	        url: '/admin/order/detail2',
		    	        method: 'GET',
		    	        data: {order_id: order_id},
		    	        success: function(result) {
		    	            if (result) {
		    	                
		    	        	    document.getElementById("order_id").value = result.order_id;
		    	        	    document.getElementById("order_partner").value = result.order_partner;
		    	        	    document.getElementById("order_sender").value = result.order_sender;
		    	        	    document.getElementById("order_date").value = result.order_date;
		    	        	    document.getElementById("order_amount").value = result.order_amount;
		    	        	    document.getElementById("order_sum").value = result.order_sum;
		    	        	    document.getElementById("order_status").value = result.order_status;
		    	        	    document.getElementById("order_manager").value = result.order_manager;
		    	        	    document.getElementById("order_delivery").value = result.order_delivery;
		    	        	    document.getElementById("order_memo").value = result.order_memo;
		    	        	    
		    	        	    const modal = document.getElementById('modalContainer');
		    			  	      modal.classList.remove('hidden');
		    	        	      
		    	            } else {
		    	                alert("No data received");
		    	            }
		    	        },
		    	        error: function(xhr, status, error) {
		    	            alert("Ajax request failed");
		    	        }
		    	    });
		    	    
		    	    $.ajax({
		    	        url: '/admin/order/detail',
		    	        method: 'GET',
		    	        data: { orderDetail_orderid: order_id },
		    	        success: function(result) {
		    	            if (result && result.length > 0) {
		    	                const tbody = document.querySelector('#productListContainer tbody');
		    	                tbody.innerHTML = ''; // 기존 데이터를 초기화

		    	                // 리스트를 순회하며 테이블 행 생성
		    	                result.forEach((detail) => {
		    	                    const tr = document.createElement('tr');
		    	                    tr.innerHTML = `
		    	                        <td style="text-align: center;">${detail.orderDetail_id}</td>
		    	                        <td style="text-align: center;">${detail.orderDetail_orderid}</td>
		    	                        <td style="text-align: center;">${detail.orderDetail_productid}</td>
		    	                        <td style="text-align: center;">${detail.orderDetail_price}</td>
		    	                        <td style="text-align: center;">${detail.orderDetail_amount}</td>
		    	                        <td style="text-align: center;">${detail.orderDetail_sum}</td>
		    	                    `;
		    	                    tbody.appendChild(tr);
		    	                });

		    	                // 모달 표시
		    	                const modal = document.getElementById('modalContainer');
		    	                modal.classList.remove('hidden');
		    	            } else {
		    	                alert("데이터를 찾을 수 없습니다.");
		    	            }
		    	        },
		    	        error: function(xhr, status, error) {
		    	            alert("Ajax 요청 실패: " + xhr.status + " " + error);
		    	        }
		    	    });

		    	    
		  	      const modal = document.getElementById('modalContainer');
		  	      modal.classList.remove('hidden');


	    	}
    </script>

      
      <script>
      	  const modalOpenButton = document.getElementById('modalBtn');
	      const modalCloseButton = document.getElementById('modalCloseButton');
	      const modal = document.getElementById('modalContainer');
	
	      //modalOpenButton.addEventListener('click', () => {
	        //modal.classList.remove('hidden');
	      //});
	
	      modalCloseButton.addEventListener('click', () => {
	        modal.classList.add('hidden');
	      });
      </script>

      
      <!-- jQuery -->
      <!-- <script src="/js/jquery.min.js"></script> -->
      <script src="/js/popper.min.js"></script>
      <script src="/js/bootstrap.min.js"></script>
      <!-- wow animation -->
      <script src="/js/animate.js"></script>
      <!-- select country -->
      <script src="/js/bootstrap-select.js"></script>
      <!-- owl carousel -->
      <script src="/js/owl.carousel.js"></script> 
      <!-- chart js -->
      <script src="/js/Chart.min.js"></script>
      <script src="/js/Chart.bundle.min.js"></script>
      <script src="/js/utils.js"></script>
      <script src="/js/analyser.js"></script>
      <!-- nice scrollbar -->
      <script src="/js/perfect-scrollbar.min.js"></script>
      <script>
         var ps = new PerfectScrollbar('#sidebar');
      </script>
      <!-- custom js -->
      <script src="/js/chart_custom_style1.js"></script>
      <script src="/js/custom.js"></script>
   </body>
</html>